### TCGA co-expression {.tabset}

* Using RNA-seq data from ~9,500 primary tumor samples in TCGA, a co-expression correlation matrix (Pearson rank correlation coefficient) was calculated, indicating pairs of genes that have their expression patterns correlated in tumors
* Here, we are showing, across the main primary tumor sites in TCGA:
  - Tumor suppressor genes, proto-oncogenes or cancer driver genes with a **strong/very strong** (_r_ >= 0.6 or _r_ <= -0.6 ) correlation to genes in the target set
  - Here, a maximum of 2500 associations are shown per correlation direction, the
complete set are listed in the Excel output of oncoEnrichR


<br><br>

```{r filter_tcga_coexp, echo=F, results='asis'}

show_tcga_coexp <- list()
missing_tcga_coexp <- list()
coexp_data <- list()

for(n in c('Positive','Negative')){
    show_tcga_coexp[[n]] <- TRUE
    missing_tcga_coexp[[n]] <- FALSE
    coexp_data[[n]] <- data.frame()
  
    coexp_data[[n]] <- onc_enrich_report[['data']][['tcga']][['co_expression']] %>% 
      dplyr::filter(corrtype == n) %>%
      dplyr::select(-corrtype) %>%
      head(2500)
    
    if(n == 'Negative'){
      coexp_data[[n]] <- coexp_data[[n]] %>%
        dplyr::arrange(r)
    }
  
    if(nrow(coexp_data[[n]]) == 0){
      missing_tcga_coexp[[n]] <- TRUE
      show_tcga_coexp[[n]] <- FALSE
    }
}

```


#### Positive correlation

```{r table_browse_tcga_coexp, echo=F, results = "asis", eval = show_tcga_coexp[['Positive']]}
library(crosstalk)


coexp_genes_positive <- crosstalk::SharedData$new(coexp_data[['Positive']])

crosstalk::bscols(
  list(
    crosstalk::filter_select("target_gene", "Target gene", 
                             coexp_genes_positive, ~target_gene),
    crosstalk::filter_slider("r", "Correlation coefficient (r)", coexp_genes_positive, 
                             ~r, step = 0.05, min = 0.6, max = 1),
    crosstalk::filter_checkbox("tumor_suppressor", "Tumor suppressor (partner)", 
                               coexp_genes_positive, ~tumor_suppressor)
  ),
  list(
    crosstalk::filter_checkbox("oncogene", "Oncogene (partner)", 
                               coexp_genes_positive, ~oncogene),
    crosstalk::filter_checkbox("cancer_driver", "Cancer driver (partner)", 
                               coexp_genes_positive, ~cancer_driver),
    crosstalk::filter_select("primary_site", "Primary site", 
                             coexp_genes_positive, ~primary_site)

  )
)

htmltools::br()
DT::datatable(coexp_genes_positive, escape = F, 
              extensions=c("Buttons","Responsive"), 
              width = "100%",
              options=list(buttons = c('csv','excel'),dom = 'Bfrtip')
)


```


```{r coexp_missing_positive, echo=F, results = 'asis', eval = missing_tcga_coexp[['Positive']]}

cat('<br><br>\n <ul><li>  <i> <span style="font-size: 105%; padding: 3px; background-color:#989898; color:white">&nbsp;&nbsp;No genes in target set with strong positive correlations to tumor suppressors, oncogenes or cancer drivers.&nbsp;&nbsp; </span></i></li></ul>',sep='\n')
cat('\n')
cat('<br><br>')

```

<br><br><br>


#### Negative correlation

```{r table_browse_tcga_coexp2, echo=F, results = "asis", eval = show_tcga_coexp[['Negative']]}
library(crosstalk)


coexp_genes_negative <- crosstalk::SharedData$new(coexp_data[['Negative']])

crosstalk::bscols(
  list(
    crosstalk::filter_select("target_gene", "Target gene", 
                             coexp_genes_negative,~target_gene),
    crosstalk::filter_slider("r", "Correlation coefficient (r)", 
                             coexp_genes_negative, 
                              ~r, step = 0.05, min = -1, max = -0.6),
    crosstalk::filter_checkbox("tumor_suppressor", "Tumor suppressor (partner)", 
                               coexp_genes_negative, ~tumor_suppressor)
  ),
  list(
    crosstalk::filter_checkbox("oncogene", "Oncogene (partner)", 
                               coexp_genes_negative, ~oncogene),
    crosstalk::filter_checkbox("cancer_driver", "Cancer driver (partner)", 
                               coexp_genes_negative, ~cancer_driver),
    crosstalk::filter_select("primary_site", "Primary site", 
                             coexp_genes_negative, ~primary_site)
  )
)

htmltools::br()
DT::datatable(coexp_genes_negative, escape = F, 
              extensions=c("Buttons","Responsive"), width = "100%",
              options=list(buttons = c('csv','excel'),dom = 'Bfrtip')
)


```
<br><br>

```{r coexp_missing_negative, echo=F, results = 'asis', eval = missing_tcga_coexp[['Negative']]}
cat('<br><br>\n <ul><li>  <i> <span style="font-size: 105%; padding: 3px; background-color:#989898; color:white">&nbsp;&nbsp;No genes in target set with strong negative correlations to tumor suppressors, oncogenes or cancer drivers.&nbsp;&nbsp; </span></i></li></ul>',sep='\n')
cat('\n')
cat('<br><br>')
```

<br><br><br>
