### Protein-protein interaction network {.tabset}

* The target set is queried against known protein-protein interactions, as evident from the [STRING API (v11)](http://string-db.org)
  * Note that interactions in STRING are assembled from multiple sources, including co-expression, co-occurrence in the literature, experimental data, curated databases etc
  * In addition to potential interactions within the target set, the network is expanded with __n = `r onc_enrich_report[['config']][['ppi']][['stringdb']][['add_nodes']]`__ proteins that interact with proteins in the target set
  * Network is here restricted to interactions with __STRING association score >= `r onc_enrich_report[['config']][['ppi']][['stringdb']][['minimum_score']]`__ (range 0-1000))
  * Drugs added to the network: __`r onc_enrich_report[['config']][['ppi']][['stringdb']][['show_drugs']]`__ 
  * Three different views are shown
    * Complete protein-protein interaction network, also showing proteins with no known interactions
    * Network community structures, as detected by the fast greedy modularity optimization algorithm by [Clauset et al.](http://www.arxiv.org/abs/cond-mat/0408187)
    * Network centrality/hub scores pr. node, as measured by [Kleinberg's score](https://dl.acm.org/citation.cfm?id=324140)

<br>

* Network legend:
  * Target set proteins are **circles**, other interacting proteins are **rectangles** (note that sizes of nodes do not carry any value)
  * Tumor suppressor genes (annotated from [CancerMine](https://www.nature.com/articles/s41592-019-0422-y)) are highlighted in <span style="color:firebrick"><b>red</b></span>
  * Proto-oncogenes (annotated from [CancerMine](https://www.nature.com/articles/s41592-019-0422-y)) are highligted in <span style="color:darkolivegreen"><b>green</b></span>
  * Genes predicted to have a dual role as proto-oncogenes/tumor suppressors (annotated from [CancerMine](https://www.nature.com/articles/s41592-019-0422-y)) are highligted in <span style="color:black"><b>black</b></span>
  * Targeted drugs (from [Open Targets Platform](https://targetvalidation.org)) are highlighted in <span style="color:orange"><b>orange</b></span>
  

<br><br>

#### Complete network

```{r ppi_complete, echo = F, results = "asis", eval = T, fig.width = 12, fig.height=13}
visNetwork::visNetwork(onc_enrich_report[['data']][['ppi']][['complete_network']]$nodes, 
                       onc_enrich_report[['data']][['ppi']][['complete_network']]$edges) %>%
  visNetwork::visInteraction(multiselect=TRUE, tooltipDelay=300) %>%
  visNetwork::visIgraphLayout(layout="layout_nicely")
  #visNetwork::visPhysics(stabilization = FALSE) %>%
  #visNetwork::visEdges(smooth = FALSE)

```
<br><br>

#### Network communities

```{r ppi_community, echo = F, results = "asis", eval = T, fig.width = 12, fig.height=13}
visNetwork::visNetwork(onc_enrich_report[['data']][['ppi']][['community_network']]$nodes, 
                       onc_enrich_report[['data']][['ppi']][['community_network']]$edges) %>%
  visNetwork::visInteraction(multiselect=TRUE, tooltipDelay=300) %>%
  visNetwork::visIgraphLayout(layout="layout_nicely")
  #visNetwork::visPhysics(stabilization = FALSE) %>%
  #visNetwork::visEdges(smooth = FALSE)

```
<br><br>

#### Network hubs

```{r table_browse_ppi_hubs, echo=F, results = "asis", eval = T}

htmltools::br()
DT::datatable(onc_enrich_report[['data']][['ppi']][['hubscores']], escape = F, extensions=c("Buttons","Responsive"), width = "100%",
              options=list(buttons = c('csv','excel'),dom = 'Bfrtip', pagelength = 20)) %>%
  DT::formatStyle("symbol","hub_score", color = "white", backgroundColor = DT::styleInterval(onc_enrich_report[['config']][['disease']][['breaks']], onc_enrich_report[['config']][['disease']][['colors']]))



```
<br><br>

