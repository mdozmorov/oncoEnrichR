### CRISPR/Cas9 loss-of-fitness {.tabset}

* In [Project Score](https://score.depmap.sanger.ac.uk/), systematic genome-scale CRISPR/Cas9 drop-out screens are performed in a large number of highly-annotated cancer models to identify genes required for cell fitness in defined molecular contexts
* Here, we are showing, across the main human tissue types:
   * Genes in the target set that are annotated with a [statistically significant effect on cell fitness](https://score.depmap.sanger.ac.uk/documentation) in any of the screened cancer cell lines (__fitness score__ is here considered a quantitative measure of the reduction of cell viability elicited by a gene inactivation, via CRISPR/Cas9 targeting). The fitness score is computed based on the [BAGEL](https://github.com/francescojm/BAGELR) and [CRISPRCleanR](https://github.com/francescojm/CRISPRcleanR) algorithms. 

<br><br>


```{r filter_crispr, echo=F, results='asis'}

show_crispr_data <- T
missing_crispr_data <- F
if(nrow(onc_enrich_report[['data']][['loss_of_fitness']][['df']]) == 0){
    show_crispr_data <- F
    missing_crispr_data <- T
}

```



#### Loss-of-fitness distribution

```{r lof_crispr_plot, echo = F, results = "asis", eval = show_crispr_data, fig.width = 11, fig.height = onc_enrich_report[['config']][['loss_of_fitness']][['plot_height']]}

plotly::ggplotly(onc_enrich_report[['data']][['loss_of_fitness']][['plot']])

```


```{r crispr_missing_plot, echo=F, results = 'asis', eval = missing_crispr_data}
cat('<i>No genes in target set found with loss-of-fitness effect from CRISPR/Cas9 screens in Project Score</i>',sep='\n')
cat('\n')
```

<br><br><br>

#### Loss-of-fitness table

```{r lof_crispr_table, echo=F, results = "asis", eval = show_crispr_data}

htmltools::br()

df_display <- onc_enrich_report[['data']][['loss_of_fitness']][['df']] %>%
  dplyr::select(symbol, tissue, cmp_link) %>%
  dplyr::rename(cell_lines = cmp_link) %>%
  dplyr::mutate(loss_of_fitness = T)

DT::datatable(df_display, escape = F, extensions=c("Buttons","Responsive"), width = "100%",
              options=list(buttons = c('csv','excel'),dom = 'Bfrtip', pagelength = 20))



```

```{r crispr_missing_data, echo=F, results = 'asis', eval = missing_crispr_data}
cat('<i>No genes in target set found with loss-of-fitness effect from CRISPR/Cas9 screens in Project Score</i>',sep='\n')
cat('\n')
```

<br><br><br>
